# PDF标准文档识别系统 - 使用说明

## 系统概述

本系统基于pdfs/标准文件夹下的标准文件，提取特征信息并建立机器学习模型，然后验证I盘下所有PDF文件，将满足标准特征的PDF文件拷贝到"I盘标准"文件夹。

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行完整流程

```bash
python main.py
```

这将自动执行以下步骤：
1. 从 `pdfs/标准/` 目录提取特征
2. 训练标准文档识别模型
3. 扫描I盘并识别标准文档
4. 将标准文档复制到 `I盘标准/` 目录

## 详细使用指南

### 分步骤运行

如果只想运行特定步骤，可以使用 `--step` 参数：

#### 步骤1: 提取特征
```bash
python main.py --step 1
```
从标准PDF文件中提取特征并保存到 `model/standard_features.json`

#### 步骤2: 训练模型
```bash
python main.py --step 2
```
基于提取的特征训练随机森林分类器

#### 步骤3: 预测并复制
```bash
python main.py --step 3
```
扫描I盘，识别标准文档并复制到输出目录

### 自定义参数

#### 指定目标目录
```bash
python main.py --target "D:/Documents"
```

#### 指定输出目录
```bash
python main.py --output "./output"
```

#### 组合使用
```bash
python main.py --target "D:/Documents" --output "./output"
```

## 系统测试

运行测试脚本验证系统功能：

```bash
python test_system.py
```

测试包括：
- 依赖包检查
- 配置文件验证
- 特征提取器测试
- 模型训练器测试
- 预测器测试
- 完整流程测试

## 系统演示

运行演示脚本查看系统功能：

```bash
python demo.py
```

演示包括：
- 特征提取演示
- 模型预测演示
- 批量处理演示
- 完整流程说明

## 输出结果

### 模型文件 (model/目录)
- `standard_classifier.pkl`: 训练好的分类器模型
- `scaler.pkl`: 特征标准化器
- `feature_names.json`: 特征名称列表
- `model_info.json`: 模型训练信息
- `standard_features.json`: 提取的特征数据

### 预测结果 (I盘标准/目录)
- 识别出的标准PDF文件
- `prediction_results.json`: 详细预测结果
- `standard_files.json`: 标准文档列表
- `prediction_stats.json`: 统计信息

## 标准文档类型识别

系统能够识别以下类型的标准文档：

| 类型 | 标识 | 示例 |
|------|------|------|
| 国家标准 | GB/T, GB | GB-T 18487.1-2023 |
| 地方标准 | DB | DB4403-T 434-2024 |
| 行业标准 | NB/T, NB- | NB-T 33008.1-2018 |
| 团体标准 | T/ | T-GAEPA002-2023 |
| 企业标准 | Q/GDW | Q-GDW 354-2009 |

## 特征提取说明

### 文件名特征
- **标准类型识别**: 检测文件名中的标准类型标识
- **标准编号提取**: 提取标准编号（如18487.1）
- **年份提取**: 提取标准发布年份
- **关键词检测**: 检测电动汽车相关和标准相关关键词

### 内容特征
- **文本长度**: 提取的文本内容长度
- **关键词统计**: 统计各类关键词出现次数
- **段落分析**: 提取包含关键词的相关段落

## 模型性能

当前模型性能指标：
- **准确率**: 88.89%
- **特征维度**: 15维
- **训练样本**: 45个文件
- **标准文档**: 7个
- **非标准文档**: 38个

## 配置调整

在 `config.py` 中可以调整以下参数：

### 标准类型定义
```python
STANDARD_TYPES = {
    "GB": {"name": "国家标准", "patterns": ["GB/T", "GB "], "priority": 10},
    "DB": {"name": "地方标准", "patterns": ["DB"], "priority": 9},
    # ... 更多类型
}
```

### 关键词配置
```python
EV_KEYWORDS = ["电动汽车", "充电", "充电桩", ...]
STANDARD_KEYWORDS = ["标准", "规范", "要求", ...]
EXCLUDE_KEYWORDS = ["datasheet", "schematic", ...]
```

### 模型参数
```python
MODEL_CONFIG = {
    "min_confidence": 0.6,
    "max_pages_to_extract": 5,
    "min_text_length": 100,
}
```

## 故障排除

### 常见问题

1. **依赖包缺失**
   ```
   错误: No module named 'pdfplumber'
   解决: pip install -r requirements.txt
   ```

2. **标准目录不存在**
   ```
   错误: 标准文件目录不存在: ./pdfs/标准
   解决: 确保pdfs/标准目录存在且包含PDF文件
   ```

3. **I盘不存在**
   ```
   错误: 目标目录不存在: I:
   解决: 使用 --target 参数指定正确的目录
   ```

4. **权限问题**
   ```
   错误: Permission denied
   解决: 确保有读写目标目录的权限
   ```

### 日志分析

系统会输出详细的处理日志，包括：
- 文件扫描进度
- 特征提取状态
- 模型训练过程
- 预测结果统计

### 性能优化

对于大量文件的处理：
1. 增加 `max_pages_to_extract` 参数提高准确性
2. 调整 `min_confidence` 参数控制识别精度
3. 分批处理大目录避免内存不足

## 扩展开发

### 添加新的标准类型
1. 在 `config.py` 的 `STANDARD_TYPES` 中添加新类型
2. 更新特征提取器中的模式匹配规则
3. 重新训练模型

### 优化特征提取
1. 修改 `extractor.py` 中的特征提取逻辑
2. 添加新的特征维度
3. 调整特征权重

### 使用不同的模型
1. 修改 `trainer.py` 中的模型选择
2. 尝试其他机器学习算法
3. 调整模型参数

## 技术支持

如果遇到问题，请：
1. 运行 `python test_system.py` 检查系统状态
2. 查看错误日志和输出信息
3. 检查配置文件和目录结构
4. 参考本文档的故障排除部分

## 更新日志

### v1.0.0
- 初始版本发布
- 支持标准文档识别
- 完整的特征提取和模型训练流程
- 批量处理和文件复制功能 